# Place at: values/<cluster>/<appset>/<namespace>/<chart>/<release>.yaml
# Example: values/prod/infra/kube-system/metrics-server/metrics-server.yaml

replicaCount: 2

image:
  repository: registry.k8s.io/metrics-server/metrics-server
  tag: v0.7.0
  pullPolicy: IfNotPresent

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 200m
    memory: 256Mi

args:
  - --kubelet-preferred-address-types=InternalIP
  - --kubelet-insecure-tls

serviceAccount:
  create: true
  name: metrics-server

podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/port: "8080"

# ArgoCD Application overrides (optional)
application:
  metadata:
    annotations:
      notifications.argoproj.io/subscribe.on-sync-succeeded.slack: deployments
      notifications.argoproj.io/subscribe.on-sync-failed.slack: alerts
  spec:
    syncPolicy:
      automated:
        prune: true
        selfHeal: true
      syncOptions:
        - CreateNamespace=true
        - ServerSideApply=true
    ignoreDifferences:
      - group: apps
        kind: Deployment
        jsonPointers:
          - /spec/replicas
